#!/usr/bin/env ruby

`export RBENV_VERSION=2.7.1`

puts(`ruby --version`)

require_relative '../lib/passy.rb'

require 'pry'

# Convert a password stored into the clipboard
# bin/encrypt --clipboard

# bin/encrypt --password '1%195bDf!g'
# 6!105BdF%g

# Get back the password from the clipboard
# bin/encrypt --clipboard --direction 'backward'
# 1%195bDf!g

encryptor = Passy::Ui.new
password = encryptor.convert
puts password

require 'erb'
class Html
  attr_reader :password

  def initialize(password)
    @password = password
  end

  def render
    b = binding
    # create and run templates, filling member data variables
    html = <<-HTML
      <!doctype html>
      <html>
        <head>
          <style type="text/css">
            h1 {
              text-align: center;
              font-size: 3.5em;
            }
          </style>
        </head>
        <body>
          <h1>
            <%= @password %>
          </h1>
        </body>
      </html>
    HTML
    ERB.new(html).result(b)
  end
end

File.open('index.html', 'w') { |f| f.write(Html.new(password).render) }

`open index.html`

sleep(1)

`rm -v index.html`

`export RBENV_VERSION=`
